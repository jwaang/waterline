{"id":"waterline-a16","title":"Waterline MVP — iOS Pacing Companion","description":"Native Swift/SwiftUI iOS + Apple Watch pacing companion for alcohol consumption. Helps users drink less by inserting structured water breaks during \"Night Out\" sessions. Core mechanic: Waterline indicator that rises with alcoholic drinks and lowers with water. Includes phone app, Apple Watch companion, WidgetKit widgets, Live Activity, and Convex cloud sync.\n\nSource PRD: ./tasks/prd-waterline-mvp-ios-pacing-companion.md","status":"open","priority":2,"issue_type":"epic","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:08:57.224654-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:08:57.224654-06:00","external_ref":"prd:./tasks/prd-waterline-mvp-ios-pacing-companion.md"}
{"id":"waterline-a16.1","title":"US-001: Initialize Xcode project with all targets","description":"As a developer, I want a properly structured Xcode project so that all targets are configured from the start.\n\n## Acceptance Criteria\n- [ ] New Xcode project named \"Waterline\" with bundle ID `com.waterline.app`\n- [ ] SwiftUI App target (iOS 17+)\n- [ ] watchOS companion app target (watchOS 10+)\n- [ ] WidgetKit extension target\n- [ ] App Intent extension target (for interactive widgets/Live Activity actions)\n- [ ] Project builds successfully for all targets\n- [ ] Folder structure: `Waterline/`, `WaterlineWatch/`, `WaterlineWidgets/`, `WaterlineIntents/`, `WaterlineTests/`\n- [ ] Swift Testing framework configured in test target\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] Verify in iOS Simulator that the app launches","status":"open","priority":0,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:09:29.046089-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:09:29.046089-06:00","dependencies":[{"issue_id":"waterline-a16.1","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:09:29.050708-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.10","title":"US-009: Start session","description":"As a user, I want to start a \"Night Out\" session so I can begin tracking.\n\n## Acceptance Criteria\n- [ ] Tapping \"Start Session\" creates a new `Session` in SwiftData with `startTime = now`, `isActive = true`\n- [ ] Only one active session allowed — if one exists, navigate to it instead\n- [ ] Session syncs to Convex in background\n- [ ] Navigates to Active Session screen\n- [ ] Live Activity starts (handled in separate story, but session creation triggers it)\n- [ ] Tests verify session creation and single-active constraint\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Verify in iOS Simulator that session starts correctly","status":"open","priority":1,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:11:07.681905-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:11:07.681905-06:00","dependencies":[{"issue_id":"waterline-a16.10","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:11:07.683179-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.10","depends_on_id":"waterline-a16.7","type":"blocks","created_at":"2026-02-12T17:13:53.145304-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.11","title":"US-010: Active session screen — Waterline indicator","description":"As a user, I want to see my current Waterline balance prominently during a session.\n\n## Acceptance Criteria\n- [ ] Waterline indicator displays as a vertical gauge/bar with a center line representing \"balanced\"\n- [ ] Indicator shows current `waterlineValue` visually: above center = over-paced, below center = buffered\n- [ ] Normal state: neutral/calm accent color\n- [ ] Warning state: when `waterlineValue \u003e= warningThreshold`, indicator turns red/amber with text \"Drink water to return to center\"\n- [ ] Indicator animates smoothly when value changes\n- [ ] Verified in Simulator: indicator renders correctly at values -3, 0, 1, 2, 3, 5\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Verify in iOS Simulator that indicator renders and animates correctly","status":"open","priority":1,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:11:08.128609-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:11:08.128609-06:00","dependencies":[{"issue_id":"waterline-a16.11","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:11:08.129661-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.11","depends_on_id":"waterline-a16.10","type":"blocks","created_at":"2026-02-12T17:13:53.852265-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.11","depends_on_id":"waterline-a16.9","type":"blocks","created_at":"2026-02-12T17:13:54.205857-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.12","title":"US-011: Active session screen — counters and reminder status","description":"As a user, I want to see my drink/water counts and when my next reminder is due.\n\n## Acceptance Criteria\n- [ ] Display: total alcoholic drink count, total water count\n- [ ] Display: \"Water due in: X drinks\" (based on `alcoholCountSinceLastWater` vs `waterEveryNDrinks`)\n- [ ] Display: \"Next reminder: X:XX\" (countdown to next time-based reminder, if enabled)\n- [ ] Counters update immediately when a log is added\n- [ ] Verified in Simulator\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Verify in iOS Simulator that counters update correctly","status":"open","priority":2,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:11:08.574939-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:11:08.574939-06:00","dependencies":[{"issue_id":"waterline-a16.12","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:11:08.575992-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.12","depends_on_id":"waterline-a16.11","type":"blocks","created_at":"2026-02-12T17:13:54.558386-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.13","title":"US-012: Log alcoholic drink — full flow","description":"As a user, I want to log an alcoholic drink with type and size so the Waterline updates accurately.\n\n## Acceptance Criteria\n- [ ] Drink type picker: beer, wine, liquor, cocktail\n- [ ] Size presets per type (e.g., beer: 12oz/16oz/pint; wine: 5oz/glass; liquor: 1.5oz/double 3oz; cocktail: standard/strong)\n- [ ] Each preset maps to a `standardDrinkEstimate` (Double) — e.g., 12oz beer = 1.0, double whiskey = 2.0\n- [ ] User can see and optionally adjust the `standardDrinkEstimate` before confirming\n- [ ] On confirm: `LogEntry` created with `type: .alcohol`, `alcoholMeta` populated, `source: .phone`\n- [ ] Waterline value increases by `standardDrinkEstimate` (rounded or fractional as stored)\n- [ ] `alcoholCountSinceLastWater` incremented by 1\n- [ ] If `alcoholCountSinceLastWater \u003e= waterEveryNDrinks`: trigger per-drink water reminder\n- [ ] If `waterlineValue \u003e= warningThreshold`: show warning state\n- [ ] Log syncs to Convex in background\n- [ ] Tests verify Waterline calculation, reminder trigger, warning state\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Verify in iOS Simulator that drink logging flow works","status":"open","priority":1,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:11:09.024564-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:11:09.024564-06:00","dependencies":[{"issue_id":"waterline-a16.13","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:11:09.025606-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.13","depends_on_id":"waterline-a16.11","type":"blocks","created_at":"2026-02-12T17:13:54.911545-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.14","title":"US-013: Log water","description":"As a user, I want to log water quickly so the Waterline decreases.\n\n## Acceptance Criteria\n- [ ] Quick \"+\" Water button on active session screen\n- [ ] Default amount from user settings (e.g., 8oz)\n- [ ] On tap: `LogEntry` created with `type: .water`, `waterMeta.amountOz` set, `source: .phone`\n- [ ] Waterline value decreases by 1\n- [ ] `alcoholCountSinceLastWater` resets to 0\n- [ ] If `waterlineValue` drops below `warningThreshold`: clear warning state\n- [ ] Log syncs to Convex in background\n- [ ] Tests verify Waterline calculation and state reset\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Verify in iOS Simulator that water logging works","status":"open","priority":1,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:11:09.473282-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:11:09.473282-06:00","dependencies":[{"issue_id":"waterline-a16.14","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:11:09.474295-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.14","depends_on_id":"waterline-a16.11","type":"blocks","created_at":"2026-02-12T17:13:55.262638-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.15","title":"US-014: Quick-add buttons on active session","description":"As a user, I want prominent quick-add buttons for drink and water so logging takes \u003c2 taps.\n\n## Acceptance Criteria\n- [ ] Bottom of active session screen: two large tappable buttons — \"+ Drink\" and \"+ Water\"\n- [ ] \"+ Water\" immediately logs water with defaults (single tap)\n- [ ] \"+ Drink\" opens drink type/size picker (second tap to confirm)\n- [ ] Buttons are large enough for easy tapping (minimum 44pt tap target)\n- [ ] Haptic feedback on tap\n- [ ] Verified in Simulator\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Verify in iOS Simulator that quick-add buttons work with haptics","status":"open","priority":2,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:11:09.932345-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:11:09.932345-06:00","dependencies":[{"issue_id":"waterline-a16.15","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:11:09.93338-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.15","depends_on_id":"waterline-a16.13","type":"blocks","created_at":"2026-02-12T17:13:55.610383-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.15","depends_on_id":"waterline-a16.14","type":"blocks","created_at":"2026-02-12T17:13:55.962321-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.16","title":"US-015: Drink presets — create and manage","description":"As a user, I want to save custom drink presets so I can log my regular drinks with one tap.\n\n## Acceptance Criteria\n- [ ] Settings screen section: \"Quick Drinks\" / \"Presets\"\n- [ ] \"Add Preset\" flow: name, drink type, size, optional ABV, standardDrinkEstimate (user can set custom value)\n- [ ] Presets saved as `DrinkPreset` in SwiftData and synced to Convex\n- [ ] Presets appear as chips/buttons on active session screen above the quick-add buttons\n- [ ] Tapping a preset logs that drink immediately (single tap)\n- [ ] Edit and delete presets from settings\n- [ ] Tests verify preset CRUD and quick-log behavior\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Verify in iOS Simulator that preset management and quick-log work","status":"open","priority":2,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:11:28.080318-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:11:28.080318-06:00","dependencies":[{"issue_id":"waterline-a16.16","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:11:28.081562-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.16","depends_on_id":"waterline-a16.13","type":"blocks","created_at":"2026-02-12T17:13:56.313781-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.17","title":"US-016: Drink presets — default presets on first launch","description":"As a new user, I want sensible default presets so I can start logging immediately.\n\n## Acceptance Criteria\n- [ ] On first launch after onboarding, create default presets: \"Beer\" (12oz, 1.0 std), \"Glass of Wine\" (5oz, 1.0 std), \"Shot\" (1.5oz, 1.0 std), \"Cocktail\" (1 std), \"Double\" (3oz, 2.0 std)\n- [ ] Defaults are editable and deletable by user\n- [ ] Tests verify default presets are created\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass","status":"open","priority":2,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:11:28.531362-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:11:28.531362-06:00","dependencies":[{"issue_id":"waterline-a16.17","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:11:28.532384-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.17","depends_on_id":"waterline-a16.6","type":"blocks","created_at":"2026-02-12T17:13:53.499257-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.18","title":"US-017: Edit and delete log entries","description":"As a user, I want to edit or delete a log entry if I made a mistake.\n\n## Acceptance Criteria\n- [ ] In active session: swipe-to-delete or edit on log timeline\n- [ ] In session summary: same edit/delete capability\n- [ ] On edit/delete: Waterline and all counters recomputed from scratch by replaying all remaining logs in order\n- [ ] Edits sync to Convex\n- [ ] Tests verify recomputation is correct after delete and edit\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Verify in iOS Simulator that edit/delete and recomputation work","status":"open","priority":2,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:11:45.413681-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:11:45.413681-06:00","dependencies":[{"issue_id":"waterline-a16.18","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:11:45.414894-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.18","depends_on_id":"waterline-a16.13","type":"blocks","created_at":"2026-02-12T17:13:56.665033-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.18","depends_on_id":"waterline-a16.14","type":"blocks","created_at":"2026-02-12T17:13:57.015733-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.19","title":"US-018: Time-based reminders","description":"As a user, I want periodic reminders to drink water during my session.\n\n## Acceptance Criteria\n- [ ] When session starts and `timeRemindersEnabled` is true: schedule local notification repeating every `timeReminderIntervalMinutes`\n- [ ] Notification content: \"Time for water\" (calm, non-judgmental)\n- [ ] Notification actions: \"Log Water\" (logs water with defaults) and \"Dismiss\"\n- [ ] \"Log Water\" action creates a `LogEntry` and updates Waterline\n- [ ] Reminders stop when session ends\n- [ ] If session inactive (no logs) for 90 minutes, stop reminders\n- [ ] Tests verify scheduling and cancellation logic\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Verify in iOS Simulator that notifications schedule and fire","status":"open","priority":2,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:11:45.868178-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:11:45.868178-06:00","dependencies":[{"issue_id":"waterline-a16.19","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:11:45.869358-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.19","depends_on_id":"waterline-a16.10","type":"blocks","created_at":"2026-02-12T17:13:57.369247-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.2","title":"US-002: Set up SwiftData models","description":"As a developer, I want the core data models defined in SwiftData so that all features can persist data locally.\n\n## Acceptance Criteria\n- [ ] `User` model: `id`, `appleUserId`, `createdAt`, `settings` (embedded)\n- [ ] `UserSettings` model: `waterEveryNDrinks` (Int, default 1), `timeRemindersEnabled` (Bool), `timeReminderIntervalMinutes` (Int, default 20), `warningThreshold` (Int, default 2), `defaultWaterAmountOz` (Int, default 8), `units` (enum: oz/ml)\n- [ ] `Session` model: `id`, `userId`, `startTime`, `endTime` (optional), `isActive` (Bool), `computedSummary` (optional)\n- [ ] `LogEntry` model: `id`, `sessionId`, `timestamp`, `type` (enum: alcohol/water), `alcoholMeta` (optional: drinkType, sizeOz, abv, standardDrinkEstimate, presetId), `waterMeta` (optional: amountOz), `source` (enum: phone/watch/widget/liveActivity)\n- [ ] `DrinkPreset` model: `id`, `userId`, `name`, `drinkType` (enum: beer/wine/liquor/cocktail), `sizeOz`, `abv` (optional), `standardDrinkEstimate` (Double)\n- [ ] All models use `@Model` macro and relationships are properly defined\n- [ ] Unit tests verify model creation, relationships, and defaults\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass","status":"open","priority":0,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:09:29.627874-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:09:29.627874-06:00","dependencies":[{"issue_id":"waterline-a16.2","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:09:29.629139-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.2","depends_on_id":"waterline-a16.1","type":"blocks","created_at":"2026-02-12T17:13:50.281169-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.20","title":"US-019: Per-drink water reminders","description":"As a user, I want a reminder to drink water after every N alcoholic drinks.\n\n## Acceptance Criteria\n- [ ] When `alcoholCountSinceLastWater \u003e= waterEveryNDrinks`: fire local notification\n- [ ] Notification content: \"You've had N drinks — time for water\"\n- [ ] Notification actions: \"Log Water\" and \"Dismiss\"\n- [ ] Reminder resets when water is logged (`alcoholCountSinceLastWater` → 0)\n- [ ] Tests verify trigger threshold and reset\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass","status":"open","priority":2,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:11:46.322974-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:11:46.322974-06:00","dependencies":[{"issue_id":"waterline-a16.20","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:11:46.32405-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.20","depends_on_id":"waterline-a16.13","type":"blocks","created_at":"2026-02-12T17:13:57.724943-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.21","title":"US-020: Pacing warning notification","description":"As a user, I want to be warned when my Waterline crosses the warning threshold.\n\n## Acceptance Criteria\n- [ ] When `waterlineValue \u003e= warningThreshold` and was previously below: fire local notification\n- [ ] Notification content: \"Your Waterline is high — drink water to return to center\"\n- [ ] Notification actions: \"Log Water\" and \"Dismiss\"\n- [ ] Only fires once per threshold crossing (not on every drink while above)\n- [ ] Tests verify threshold crossing detection\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass","status":"open","priority":2,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:11:46.77336-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:11:46.77336-06:00","dependencies":[{"issue_id":"waterline-a16.21","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:11:46.789144-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.21","depends_on_id":"waterline-a16.13","type":"blocks","created_at":"2026-02-12T17:13:58.076614-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.22","title":"US-021: End session","description":"As a user, I want to end my session and see a summary.\n\n## Acceptance Criteria\n- [ ] \"End Session\" button on active session screen (with confirmation dialog: \"End this session?\")\n- [ ] Sets `endTime`, `isActive = false`\n- [ ] Computes summary: total drinks, total water, total standard drinks, session duration, pacing adherence (% of times water was logged within the N-drink rule)\n- [ ] Stores summary in `Session.computedSummary`\n- [ ] Cancels all active reminders\n- [ ] Ends Live Activity\n- [ ] Syncs to Convex\n- [ ] Navigates to Summary screen\n- [ ] Force-end works with zero logs\n- [ ] Tests verify summary computation\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Verify in iOS Simulator that end session flow works","status":"open","priority":1,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:12:14.260543-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:12:14.260543-06:00","dependencies":[{"issue_id":"waterline-a16.22","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:12:14.261758-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.22","depends_on_id":"waterline-a16.15","type":"blocks","created_at":"2026-02-12T17:13:59.128806-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.22","depends_on_id":"waterline-a16.19","type":"blocks","created_at":"2026-02-12T17:13:59.482262-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.23","title":"US-022: Session summary screen","description":"As a user, I want to review my session after it ends.\n\n## Acceptance Criteria\n- [ ] Displays: total alcoholic drinks (count + standard drink total), total water entries (count + total volume), session duration, pacing adherence percentage\n- [ ] Timeline list: chronological log entries with timestamps, type icons, and details\n- [ ] Edit/delete log entries from summary (recomputes summary)\n- [ ] Final Waterline value displayed\n- [ ] \"Done\" button returns to Home\n- [ ] Verified in Simulator\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Verify in iOS Simulator that summary screen renders correctly","status":"open","priority":2,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:12:14.856078-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:12:14.856078-06:00","dependencies":[{"issue_id":"waterline-a16.23","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:12:14.85732-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.23","depends_on_id":"waterline-a16.22","type":"blocks","created_at":"2026-02-12T17:13:59.835071-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.24","title":"US-023: Past sessions list","description":"As a user, I want to view my past sessions so I can track my patterns.\n\n## Acceptance Criteria\n- [ ] Home screen shows last 5 sessions (date, duration, drink count, water count)\n- [ ] Tapping a session opens its summary screen (read-only, no edit in past sessions for MVP)\n- [ ] Empty state if no past sessions\n- [ ] Verified in Simulator\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Verify in iOS Simulator that past sessions list works","status":"open","priority":2,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:12:15.341712-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:12:15.341712-06:00","dependencies":[{"issue_id":"waterline-a16.24","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:12:15.342742-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.24","depends_on_id":"waterline-a16.23","type":"blocks","created_at":"2026-02-12T17:14:00.190973-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.25","title":"US-024: Settings screen","description":"As a user, I want to adjust my pacing preferences and manage my account.\n\n## Acceptance Criteria\n- [ ] Sections: Reminders (time-based toggle + interval, per-drink N), Waterline (warning threshold), Defaults (water amount, units), Presets (manage quick drinks), Account (sign out, delete account)\n- [ ] Changes save immediately to SwiftData and sync to Convex\n- [ ] Delete account: removes all user data from SwiftData and Convex, signs out, returns to onboarding\n- [ ] Verified in Simulator\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Verify in iOS Simulator that settings screen works","status":"open","priority":2,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:12:15.792343-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:12:15.792343-06:00","dependencies":[{"issue_id":"waterline-a16.25","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:12:15.79342-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.25","depends_on_id":"waterline-a16.16","type":"blocks","created_at":"2026-02-12T17:14:00.547219-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.26","title":"US-025: Abandoned session handling","description":"As a user, I want the app to handle sessions I forgot to end.\n\n## Acceptance Criteria\n- [ ] If a session has been active for \u003e12 hours: on next app launch, show prompt \"Your session has been running for X hours. End it?\"\n- [ ] Options: \"End Now\" (ends with current data) and \"Keep Going\" (session stays active)\n- [ ] Tests verify 12-hour threshold detection\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Verify in iOS Simulator that abandoned session prompt appears","status":"open","priority":3,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:12:16.241971-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:12:16.241971-06:00","dependencies":[{"issue_id":"waterline-a16.26","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:12:16.243121-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.26","depends_on_id":"waterline-a16.22","type":"blocks","created_at":"2026-02-12T17:14:00.899754-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.27","title":"US-026: Offline-first logging and sync","description":"As a user, I want to log drinks even without internet and have them sync later.\n\n## Acceptance Criteria\n- [ ] All log entries write to SwiftData first (immediate, no network required)\n- [ ] Background sync queue: pending changes sync to Convex when connectivity available\n- [ ] Conflict resolution: last-write-wins for edits\n- [ ] Sync status indicator (subtle, non-intrusive — e.g., small cloud icon)\n- [ ] Tests verify offline write and subsequent sync\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Verify in iOS Simulator that offline logging works","status":"open","priority":2,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:13:05.244532-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:13:05.244532-06:00","dependencies":[{"issue_id":"waterline-a16.27","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:13:05.245738-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.27","depends_on_id":"waterline-a16.3","type":"blocks","created_at":"2026-02-12T17:14:01.262289-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.27","depends_on_id":"waterline-a16.13","type":"blocks","created_at":"2026-02-12T17:14:01.610785-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.28","title":"US-027: Apple Watch app — main screen with quick logging","description":"As a user, I want to log drinks and water from my Apple Watch with minimal interaction.\n\n## Acceptance Criteria\n- [ ] watchOS app shows two large buttons: \"+ Drink\" and \"+ Water\" when session is active\n- [ ] \"+ Water\" logs immediately with defaults\n- [ ] \"+ Drink\" shows compact preset list, tapping one logs immediately\n- [ ] Compact Waterline indicator and counts (drinks/water) above buttons\n- [ ] If no active session: show \"Start Session\" button or \"No active session\" state\n- [ ] Watch communicates with phone via WatchConnectivity framework\n- [ ] Haptic confirmation on log\n- [ ] Verified in watchOS Simulator\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Build and verify on watchOS Simulator","status":"open","priority":3,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:13:05.693732-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:13:05.693732-06:00","dependencies":[{"issue_id":"waterline-a16.28","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:13:05.694838-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.28","depends_on_id":"waterline-a16.15","type":"blocks","created_at":"2026-02-12T17:14:04.128516-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.29","title":"US-028: Apple Watch app — haptic nudges","description":"As a user, I want my watch to buzz when it is time to drink water.\n\n## Acceptance Criteria\n- [ ] When phone fires a water reminder (time-based or per-drink), watch receives it and plays haptic\n- [ ] Haptic pattern: gentle, not alarming (e.g., `.notification` type)\n- [ ] Watch shows reminder notification with \"Log Water\" action\n- [ ] Tapping \"Log Water\" on watch logs water and sends to phone\n- [ ] Tests verify WatchConnectivity message handling\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Build and verify on watchOS Simulator","status":"open","priority":3,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:13:06.142839-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:13:06.142839-06:00","dependencies":[{"issue_id":"waterline-a16.29","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:13:06.143997-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.29","depends_on_id":"waterline-a16.28","type":"blocks","created_at":"2026-02-12T17:14:04.482188-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.29","depends_on_id":"waterline-a16.19","type":"blocks","created_at":"2026-02-12T17:14:04.832426-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.3","title":"US-003: Set up Convex backend schema and sync foundation","description":"As a developer, I want Convex configured with matching schema so that data can sync to the cloud.\n\n## Acceptance Criteria\n- [ ] Convex project initialized with `npx convex init`\n- [ ] Convex schema defined matching SwiftData models: `users`, `sessions`, `logEntries`, `drinkPresets` tables\n- [ ] Convex auth provider configured for Sign in with Apple (use built-in if available, otherwise custom function that accepts Apple identity token and creates/verifies user)\n- [ ] If Convex Swift SDK exists and is usable: integrate it; otherwise use Convex HTTP API via `URLSession` async/await\n- [ ] Basic CRUD mutation functions: `createUser`, `upsertSession`, `addLogEntry`, `deleteLogEntry`, `upsertDrinkPreset`\n- [ ] Basic query functions: `getActiveSession`, `getSessionLogs`, `getUserPresets`\n- [ ] Convex deployment works (`npx convex dev` runs without errors)\n- [ ] Swift service layer (`ConvexService`) that wraps API calls with async/await\n- [ ] Tests verify Convex functions work (can be integration tests or function-level tests)\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] `npx convex dev` runs without errors","status":"open","priority":0,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:09:30.084364-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:09:30.084364-06:00","dependencies":[{"issue_id":"waterline-a16.3","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:09:30.086419-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.3","depends_on_id":"waterline-a16.2","type":"blocks","created_at":"2026-02-12T17:13:50.636677-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.30","title":"US-029: Apple Watch app — end session from watch","description":"As a user, I want to end my session from the watch if my phone is not handy.\n\n## Acceptance Criteria\n- [ ] \"End Session\" option accessible from watch (e.g., scroll down or menu)\n- [ ] Confirmation prompt on watch\n- [ ] Ends session on phone via WatchConnectivity\n- [ ] Watch updates to \"no active session\" state\n- [ ] Verified in watchOS Simulator\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Build and verify on watchOS Simulator","status":"open","priority":3,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:13:06.592328-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:13:06.592328-06:00","dependencies":[{"issue_id":"waterline-a16.30","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:13:06.593364-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.30","depends_on_id":"waterline-a16.28","type":"blocks","created_at":"2026-02-12T17:14:05.18712-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.30","depends_on_id":"waterline-a16.22","type":"blocks","created_at":"2026-02-12T17:14:05.537363-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.31","title":"US-030: Lock Screen widget","description":"As a user, I want to glance at my Waterline status on my Lock Screen.\n\n## Acceptance Criteria\n- [ ] Lock Screen widget (WidgetKit, accessory family)\n- [ ] Shows: simplified Waterline indicator, drink/water counts\n- [ ] If interactive (iOS 17+): \"+ Drink\" and \"+ Water\" buttons via App Intents\n- [ ] Tapping buttons logs with defaults without opening the app\n- [ ] Widget updates when logs are added (via WidgetKit timeline reload)\n- [ ] When no active session: shows \"No Session\" state\n- [ ] Verified in Simulator widget preview\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Verify in Simulator widget preview","status":"open","priority":3,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:13:07.048067-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:13:07.048067-06:00","dependencies":[{"issue_id":"waterline-a16.31","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:13:07.049327-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.31","depends_on_id":"waterline-a16.34","type":"blocks","created_at":"2026-02-12T17:14:03.40921-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.32","title":"US-031: Home Screen widget","description":"As a user, I want a Home Screen widget to see session status and quick-log.\n\n## Acceptance Criteria\n- [ ] Small widget: Waterline indicator + quick-add buttons\n- [ ] Medium widget: Waterline + counts + next reminder countdown\n- [ ] Large widget: Waterline + counts + recent 3 log entries + quick-add\n- [ ] Interactive buttons via App Intents (iOS 17+)\n- [ ] Widget timeline updates on log events\n- [ ] When no active session: shows \"Start Session\" or last session summary\n- [ ] Verified in Simulator widget preview\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Verify in Simulator widget preview","status":"open","priority":3,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:13:07.501801-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:13:07.501801-06:00","dependencies":[{"issue_id":"waterline-a16.32","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:13:07.502826-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.32","depends_on_id":"waterline-a16.34","type":"blocks","created_at":"2026-02-12T17:14:03.761798-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.33","title":"US-032: Live Activity / Dynamic Island","description":"As a user, I want to see my session status in the Dynamic Island and Live Activity without opening the app.\n\n## Acceptance Criteria\n- [ ] Live Activity starts when session starts\n- [ ] Displays: Waterline value, drink count, water count, next reminder countdown\n- [ ] Dynamic Island compact: Waterline indicator and counts\n- [ ] Dynamic Island expanded: Waterline + counts + quick actions\n- [ ] Quick actions via App Intents: \"+ Drink\" (logs default preset), \"+ Water\"\n- [ ] Updates in near-real-time when logs are added\n- [ ] Live Activity ends when session ends\n- [ ] Uses ActivityKit with proper `ActivityAttributes` and `ContentState`\n- [ ] Verified in Simulator\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Verify in iOS Simulator that Live Activity renders correctly","status":"open","priority":2,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:13:07.958674-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:13:07.958674-06:00","dependencies":[{"issue_id":"waterline-a16.33","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:13:07.959682-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.33","depends_on_id":"waterline-a16.34","type":"blocks","created_at":"2026-02-12T17:14:02.695042-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.33","depends_on_id":"waterline-a16.11","type":"blocks","created_at":"2026-02-12T17:14:03.044577-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.34","title":"US-033: App Intents for interactive widgets and Live Activity","description":"As a developer, I want App Intents defined so that widgets and Live Activity can perform actions.\n\n## Acceptance Criteria\n- [ ] `LogDrinkIntent`: logs an alcoholic drink (accepts optional preset ID, defaults to \"standard drink\" 1.0)\n- [ ] `LogWaterIntent`: logs water with default amount\n- [ ] `StartSessionIntent`: starts a new session\n- [ ] `EndSessionIntent`: ends the active session\n- [ ] Intents registered in App Intents extension\n- [ ] Intents work from widgets, Live Activity, and Siri\n- [ ] Tests verify intent execution and data creation\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass","status":"open","priority":2,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:13:08.412677-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:13:08.412677-06:00","dependencies":[{"issue_id":"waterline-a16.34","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:13:08.413839-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.34","depends_on_id":"waterline-a16.13","type":"blocks","created_at":"2026-02-12T17:14:01.972465-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.34","depends_on_id":"waterline-a16.14","type":"blocks","created_at":"2026-02-12T17:14:02.333975-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.35","title":"US-035: Notification permission request during onboarding","description":"As a user, I want the app to explain why it needs notifications before asking permission.\n\n## Acceptance Criteria\n- [ ] After configure-defaults screen: explanation screen \"Waterline sends gentle reminders to drink water during your session. Allow notifications to get pacing nudges.\"\n- [ ] \"Enable Notifications\" button triggers system permission prompt\n- [ ] \"Skip\" option — reminders will only work in-app\n- [ ] Permission result stored; if denied, reminders settings show \"Notifications disabled\" with link to Settings\n- [ ] Verified in Simulator\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Verify in iOS Simulator that notification permission flow works","status":"open","priority":2,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:13:08.862514-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:13:08.862514-06:00","dependencies":[{"issue_id":"waterline-a16.35","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:13:08.863531-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.35","depends_on_id":"waterline-a16.6","type":"blocks","created_at":"2026-02-12T17:13:52.441012-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.36","title":"US-036: Discreet notification content","description":"As a user, I want notification text that will not be embarrassing if someone sees my Lock Screen.\n\n## Acceptance Criteria\n- [ ] Default notification content uses neutral language: \"Time for a break\" instead of \"You have had 5 drinks\"\n- [ ] No drink counts or alcohol references in notification preview text\n- [ ] Full detail visible only when notification is expanded or app is opened\n- [ ] Configurable in Settings: \"Discreet notifications\" toggle (on by default)\n- [ ] Tests verify notification content based on discreet setting\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass","status":"open","priority":3,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:13:09.315582-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:13:09.315582-06:00","dependencies":[{"issue_id":"waterline-a16.36","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:13:09.316637-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.36","depends_on_id":"waterline-a16.19","type":"blocks","created_at":"2026-02-12T17:13:58.428134-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.4","title":"US-004: Sign in with Apple authentication flow","description":"As a user, I want to sign in with my Apple ID so that my data is tied to my account.\n\n## Acceptance Criteria\n- [ ] Sign in with Apple button on launch/onboarding screen using `SignInWithAppleButton`\n- [ ] On successful Apple auth, identity token sent to Convex to create/verify user\n- [ ] User record created in both SwiftData (local) and Convex (remote) on first login\n- [ ] Auth state persisted locally — user stays signed in across app launches\n- [ ] If Convex auth provider supports Apple natively, use that; otherwise custom token exchange via Convex function\n- [ ] Error handling: show alert on auth failure with retry option\n- [ ] Tests verify auth state management and token handling\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Verify in iOS Simulator that Sign in with Apple flow works","status":"open","priority":1,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:09:54.782633-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:09:54.782633-06:00","dependencies":[{"issue_id":"waterline-a16.4","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:09:54.783785-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.4","depends_on_id":"waterline-a16.3","type":"blocks","created_at":"2026-02-12T17:13:51.33958-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.5","title":"US-005: Onboarding flow — welcome and guardrail screens","description":"As a new user, I want a brief onboarding that explains what Waterline does and sets expectations.\n\n## Acceptance Criteria\n- [ ] Welcome screen: \"Waterline helps you pace and drink less by adding water breaks.\"\n- [ ] Guardrail screen: \"This is a pacing tool. It does not estimate intoxication or guarantee how you'll feel tomorrow.\"\n- [ ] Screens use SwiftUI with calm, minimalist styling\n- [ ] Navigation: Welcome → Guardrail → Sign in with Apple → Configure defaults\n- [ ] Onboarding only shows once (persisted flag)\n- [ ] Verified in Simulator: screens display correctly, navigation works\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Verify in iOS Simulator that onboarding flow works","status":"open","priority":1,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:09:55.296541-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:09:55.296541-06:00","dependencies":[{"issue_id":"waterline-a16.5","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:09:55.297871-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.5","depends_on_id":"waterline-a16.4","type":"blocks","created_at":"2026-02-12T17:13:51.694128-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.6","title":"US-006: Onboarding flow — configure defaults","description":"As a new user, I want to set my pacing preferences during onboarding so the app works for me from the first session.\n\n## Acceptance Criteria\n- [ ] Configuration screen with: water every N drinks (stepper, min 1, default 1), time-based reminders toggle + interval picker (10/15/20/30/45/60 min), warning threshold (stepper, min 1, default 2), units (oz/ml toggle)\n- [ ] Values saved to `UserSettings` in SwiftData\n- [ ] \"Done\" button completes onboarding and navigates to Home\n- [ ] Request notification permission with explanation before asking (\"Waterline sends gentle reminders to drink water during your session\")\n- [ ] Tests verify settings are persisted correctly\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Verify in iOS Simulator that configuration screen works","status":"open","priority":1,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:09:55.75009-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:09:55.75009-06:00","dependencies":[{"issue_id":"waterline-a16.6","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:09:55.751186-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.6","depends_on_id":"waterline-a16.5","type":"blocks","created_at":"2026-02-12T17:13:52.046936-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.7","title":"US-007: Home screen — no active session state","description":"As a user, I want to see a clear home screen that lets me start a session or view past sessions.\n\n## Acceptance Criteria\n- [ ] Primary CTA: \"Start Session\" button (prominent)\n- [ ] Secondary: Settings icon/button, Past Sessions list (last 5 sessions with date, duration, drink/water counts)\n- [ ] If no past sessions, show empty state message\n- [ ] Tapping a past session navigates to summary view\n- [ ] Verified in Simulator\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Verify in iOS Simulator that home screen renders correctly","status":"open","priority":1,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:10:12.346015-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:10:12.346015-06:00","dependencies":[{"issue_id":"waterline-a16.7","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:10:12.347098-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.7","depends_on_id":"waterline-a16.6","type":"blocks","created_at":"2026-02-12T17:13:52.798231-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.8","title":"US-008: Home screen — active session state","description":"As a user returning to the app with an active session, I want to immediately see my session status.\n\n## Acceptance Criteria\n- [ ] If active session exists: show Waterline indicator, current counts (drinks/water), and \"View Session\" CTA\n- [ ] Quick-add buttons visible: \"+ Drink\" and \"+ Water\"\n- [ ] Session auto-recovery: if app was killed and session is still active, this state appears on relaunch\n- [ ] Verified in Simulator\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass\n- [ ] Verify in iOS Simulator that active session home state works","status":"open","priority":2,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:10:12.786103-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:10:12.786103-06:00","dependencies":[{"issue_id":"waterline-a16.8","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:10:12.787205-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.8","depends_on_id":"waterline-a16.11","type":"blocks","created_at":"2026-02-12T17:13:58.778018-06:00","created_by":"Jonathan Wang"}]}
{"id":"waterline-a16.9","title":"US-034: Waterline algorithm — recompute engine","description":"As a developer, I want a reliable algorithm that recomputes Waterline state from logs so edits are always consistent.\n\n## Acceptance Criteria\n- [ ] `WaterlineEngine` struct/class with method `computeState(from logs: [LogEntry]) -\u003e WaterlineState`\n- [ ] `WaterlineState`: `waterlineValue` (Double), `alcoholCountSinceLastWater` (Int), `totalAlcoholCount` (Int), `totalWaterCount` (Int), `totalStandardDrinks` (Double), `isWarning` (Bool)\n- [ ] On alcohol log: `waterlineValue += standardDrinkEstimate`, `alcoholCountSinceLastWater += 1`\n- [ ] On water log: `waterlineValue -= 1`, `alcoholCountSinceLastWater = 0`\n- [ ] Warning: `waterlineValue \u003e= warningThreshold`\n- [ ] Engine processes logs in timestamp order\n- [ ] Used everywhere state is needed (active session, summary, after edits)\n- [ ] Comprehensive tests: empty logs, alternating drinks/water, doubles, edits, warning threshold crossing\n\n## Quality Gates\n- [ ] `xcodebuild build` — Project compiles without errors\n- [ ] `swift test` — All Swift Testing tests pass","status":"open","priority":0,"issue_type":"task","owner":"jonathan.wang1996@gmail.com","created_at":"2026-02-12T17:10:30.267568-06:00","created_by":"Jonathan Wang","updated_at":"2026-02-12T17:10:30.267568-06:00","dependencies":[{"issue_id":"waterline-a16.9","depends_on_id":"waterline-a16","type":"parent-child","created_at":"2026-02-12T17:10:30.268679-06:00","created_by":"Jonathan Wang"},{"issue_id":"waterline-a16.9","depends_on_id":"waterline-a16.2","type":"blocks","created_at":"2026-02-12T17:13:50.986899-06:00","created_by":"Jonathan Wang"}]}
